<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <title>Camera Kit Local Test</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      background: #000;
      color: rgb(235, 235, 235);
      font-family: Arial, sans-serif;
    }

    .container {
      display: flex;
      flex: 1;
    }

    .left-bar {
      width: 6%;
      background: #000000;
      height: 100%;
    }

    .left-main {
      width: 29%;
      display: flex;
      flex-direction: column;
    }

    .circle {
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      background: rgb(119, 209, 247);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .circle canvas,
    .circle video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform: scaleX(-1);
      transition: transform 0.3s ease;
    }

    .bottom {
      background: #000;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 15px;
    }

    .info-card {
      background: rgba(255, 255, 255, 0.08);
      padding: 15px 20px;
      border-radius: 10px;
      max-width: 90%;
      color: #feefe5;
      text-align: left;
      font-size: 15px;
      line-height: 1.6;
    }

    .info-card h3 {
      margin: 0 0 10px 0;
      font-size: 18px;
      color: #00916e;
    }

    .info-card table {
      width: 100%;
      border-collapse: collapse;
    }

    .info-card th {
      text-align: left;
      padding: 4px 8px;
      vertical-align: top;
      width: 100px;
      color: rgb(238, 97, 35);
    }

    .info-card td {
      padding: 4px 8px;
    }

    .info-card ul {
      margin: 4px 0 0 15px;
      padding: 0;
    }

    .right {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
    }

    .right-circle {
      aspect-ratio: 1 / 1;
      width: 100%;
      border-radius: 50%;
      background: rgb(242, 109, 27);
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;  /* ✅ 讓 donut 可以絕對定位在裡面 */
  

    }
#donutImage {
  position: absolute;
  width: 100%;         /* 調整甜甜圈大小比例 */
  height: auto;
  pointer-events: none;  /* 不影響點擊事件 */
  z-index: 5;           /* 在最上層顯示 */
}
    .right-circle video,
    .right-circle canvas {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform: scaleX(-1);
      transition: transform 0.3s ease;
    }

    .right-bar {
      width: 7%;
      background: #000000;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 20px;
      gap: 15px;
    }

    .swap-btn,
    .reconnect-btn,
    .rotate-btn {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      color: #feefe5;
      cursor: pointer;
      font-size: 14px;
    }

    .swap-btn {
      background: #00916E;
    }

    .swap-btn:hover {
      background: #035407;
    }

    .reconnect-btn {
      background: #E84D34;
    }

    .reconnect-btn:hover {
      background: #A03423;
    }

    .rotate-btn {
      background: #347ae8;
    }

    .rotate-btn:hover {
      background: #2556a8;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="left-bar"></div>

    <div class="left-main">
      <div class="circle local" id="leftCircle">
        <video id="remoteVideo" autoplay playsinline></video>
      </div>
    </div>

    <div class="right">
      <div class="right-circle" id="rightCircle">
        <canvas id="localCanvas"></canvas>
          <img id="donutImage" src="Lens.png" alt="甜甜圈" />
      </div>
    </div>

    <div class="right-bar">
      <button class="swap-btn" id="swapBtn">切換位置</button>
      <button class="rotate-btn" id="rotateBtn">旋轉畫面</button>
      <button class="reconnect-btn" id="reconnectBtn">重新連線</button>
    </div>
  </div>

  <script type="module" src="/client.js"></script>
  <script>
    const swapBtn = document.getElementById("swapBtn");
    const rotateBtn = document.getElementById("rotateBtn");
    const localCanvas = document.getElementById("localCanvas");
    const remoteVideo = document.getElementById("remoteVideo");
    const leftCircle = document.getElementById("leftCircle");
    const rightCircle = document.getElementById("rightCircle");

    let swapped = false;
    let rotation = 180; // ✅ 一開始就是 180 度

    // ✅ 一開始就把 localCanvas 設成反的（水平 + 180 度）
    localCanvas.style.transform = `scaleX(-1) rotate(${rotation}deg)`;

    swapBtn.addEventListener("click", () => {
      if (!swapped) {
        rightCircle.innerHTML = "";
        rightCircle.appendChild(localCanvas);
        leftCircle.innerHTML = "";
        leftCircle.appendChild(remoteVideo);
      } else {
        leftCircle.innerHTML = "";
        leftCircle.appendChild(localCanvas);
        rightCircle.innerHTML = "";
        rightCircle.appendChild(remoteVideo);
      }
      swapped = !swapped;
    });

    rotateBtn.addEventListener("click", () => {
      rotation = (rotation + 180) % 360;
      localCanvas.style.transform = `scaleX(-1) rotate(${rotation}deg)`;
    });
  </script>

</body>

</html>
``